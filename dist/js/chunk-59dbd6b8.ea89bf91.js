(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59dbd6b8"],{"2f20":function(e,t,o){"use strict";o("aae2")},"41da":function(e,t,o){"use strict";o.r(t);var i=o("7a23");const s={"data-aos":"fade-in","data-aos-delay":"300",class:"modal-body"},a=Object(i["createElementVNode"])("h3",null,"Створити статтю",-1),n={class:"form-group"},r=Object(i["createElementVNode"])("label",{for:"title"},"Назва статі",-1),l={key:0},c={class:"form-group"},d=Object(i["createElementVNode"])("label",null,"Текст",-1),p={key:0},m={class:"form-group"},g=Object(i["createElementVNode"])("label",null,"Короткий опис",-1),h={key:0},u={key:0,class:"form-group"},b=Object(i["createElementVNode"])("label",null,"Оберіть міста",-1),O={class:"multiselect-tag is-user"},f=["onMousedown"],j={key:1,class:"form-group"},v=Object(i["createElementVNode"])("label",null,"Оберіть країни",-1),k={class:"multiselect-tag is-user"},V=["onMousedown"],_={key:2,class:"form-group"},N=Object(i["createElementVNode"])("label",null,"Оберіть теги",-1),y={class:"multiselect-tag is-user"},w=["onMousedown"],E={class:"form-group"},C=Object(i["createElementVNode"])("label",null,"Завантажте фото",-1),M={key:3,class:"content"},L={class:"cropper-area"},R={class:"img-cropper"},S={class:"preview-area"},B=Object(i["createElementVNode"])("label",null,"Обрізане фото",-1),T={class:"cropped-image"},D=["src"],$={key:1,class:"crop-placeholder"},U=Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("button",{type:"submit",style:{margin:"1px"},class:"btn btn-primary"},"Створити статтю")],-1),x={ref:"googleMap",class:"google-map"};function I(e,t,o,I,P,A){const F=Object(i["resolveComponent"])("ckeditor"),X=Object(i["resolveComponent"])("Multiselect"),Y=Object(i["resolveComponent"])("vue-cropper");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("div",s,[a,Object(i["createElementVNode"])("form",{onSubmit:t[15]||(t[15]=Object(i["withModifiers"])((...e)=>A.create&&A.create(...e),["prevent"])),style:{margin:"1px"},enctype:"multipart/form-data"},[Object(i["createElementVNode"])("div",n,[r,Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{class:"form-control","onUpdate:modelValue":t[0]||(t[0]=t=>e.title=t),id:"title",required:""},null,512),[[i["vModelText"],e.title]]),e.msg.title?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",l,Object(i["toDisplayString"])(e.msg.title),1)):Object(i["createCommentVNode"])("",!0)]),Object(i["createElementVNode"])("div",c,[d,Object(i["createVNode"])(F,{class:"form-control",editor:e.editor,modelValue:e.content,"onUpdate:modelValue":t[1]||(t[1]=t=>e.content=t),config:e.editorConfig},null,8,["editor","modelValue","config"]),e.msg.content?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",p,Object(i["toDisplayString"])(e.msg.content),1)):Object(i["createCommentVNode"])("",!0)]),Object(i["createElementVNode"])("div",m,[g,Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{class:"form-control","onUpdate:modelValue":t[2]||(t[2]=t=>e.description=t)},null,512),[[i["vModelText"],e.description]]),e.msg.description?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",h,Object(i["toDisplayString"])(e.msg.description),1)):Object(i["createCommentVNode"])("",!0)]),e.opt_cities?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",u,[b,Object(i["createVNode"])(X,{mode:"tags",searchable:!0,modelValue:e.s_cities,"onUpdate:modelValue":t[4]||(t[4]=t=>e.s_cities=t),options:e.opt_cities},{tag:Object(i["withCtx"])(({option:e,handleTagRemove:o,disabled:s})=>[Object(i["createElementVNode"])("div",O,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.value)+" ",1),s?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("i",{key:0,onClick:t[3]||(t[3]=Object(i["withModifiers"])(()=>{},["prevent"])),onMousedown:Object(i["withModifiers"])(t=>o(e,t),["prevent","stop"])},null,40,f))])]),_:1},8,["modelValue","options"])])):Object(i["createCommentVNode"])("",!0),e.opt_countries?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",j,[v,Object(i["createVNode"])(X,{mode:"tags",searchable:!0,modelValue:e.s_countries,"onUpdate:modelValue":t[6]||(t[6]=t=>e.s_countries=t),options:e.opt_countries},{tag:Object(i["withCtx"])(({option:e,handleTagRemove:o,disabled:s})=>[Object(i["createElementVNode"])("div",k,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.value)+" ",1),s?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("i",{key:0,onClick:t[5]||(t[5]=Object(i["withModifiers"])(()=>{},["prevent"])),onMousedown:Object(i["withModifiers"])(t=>o(e,t),["prevent","stop"])},null,40,V))])]),_:1},8,["modelValue","options"])])):Object(i["createCommentVNode"])("",!0),e.opt_tags?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",_,[N,Object(i["createVNode"])(X,{mode:"tags",searchable:!0,modelValue:e.s_tags,"onUpdate:modelValue":t[8]||(t[8]=t=>e.s_tags=t),options:e.opt_tags},{tag:Object(i["withCtx"])(({option:e,handleTagRemove:o,disabled:s})=>[Object(i["createElementVNode"])("div",y,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.value)+" ",1),s?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("i",{key:0,onClick:t[7]||(t[7]=Object(i["withModifiers"])(()=>{},["prevent"])),onMousedown:Object(i["withModifiers"])(t=>o(e,t),["prevent","stop"])},null,40,w))])]),_:1},8,["modelValue","options"])])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",E,[C,Object(i["createElementVNode"])("input",{ref:"input",type:"file",name:"image",accept:"image/*",onChange:t[9]||(t[9]=(...e)=>A.setImage&&A.setImage(...e))},null,544)]),""!==e.imgSrc?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",M,[Object(i["createElementVNode"])("section",L,[Object(i["createElementVNode"])("div",R,[Object(i["createVNode"])(Y,{style:{"max-height":"40vh",display:"block"},ref:"cropper","aspect-ratio":2,src:e.imgSrc,preview:".preview"},null,8,["src"])]),Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("a",{href:"#",role:"button",class:"btn btn-theme",onClick:t[10]||(t[10]=Object(i["withModifiers"])(e=>A.rotate(-90),["prevent"]))}," Повернути "),Object(i["createElementVNode"])("a",{ref:"flipX",href:"#",role:"button",class:"btn btn-theme",onClick:t[11]||(t[11]=Object(i["withModifiers"])((...e)=>A.flipX&&A.flipX(...e),["prevent"]))}," Відзеркалити по горизонталі ",512),Object(i["createElementVNode"])("a",{ref:"flipY",href:"#",role:"button",class:"btn btn-theme",onClick:t[12]||(t[12]=Object(i["withModifiers"])((...e)=>A.flipY&&A.flipY(...e),["prevent"]))}," Відзеркалити по вертикалі ",512),Object(i["createElementVNode"])("a",{href:"#",role:"button",class:"btn btn-theme",onClick:t[13]||(t[13]=Object(i["withModifiers"])((...e)=>A.cropImage&&A.cropImage(...e),["prevent"]))}," Обрізати "),Object(i["createElementVNode"])("a",{href:"#",role:"button",class:"btn btn-theme",onClick:t[14]||(t[14]=Object(i["withModifiers"])((...e)=>A.reset&&A.reset(...e),["prevent"]))}," Скасувати ")])]),Object(i["createElementVNode"])("section",S,[B,Object(i["createElementVNode"])("div",T,[e.selected_file?(Object(i["openBlock"])(),Object(i["createElementBlock"])("img",{key:0,style:{"max-height":"40vh",display:"block","border-style":"groove"},src:e.selected_file,alt:"Cropped Image"},null,8,D)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",$))])])])):Object(i["createCommentVNode"])("",!0),U,Object(i["createElementVNode"])("div",x,null,512)],32)])])}var P=o("bc3a"),A=o.n(P),F=o("3730"),X=o.n(F),Y=o("95c3"),G=o.n(Y),W=(o("6107"),o("abd1")),z=o.n(W),Z=o("a306"),J=o("0180"),q={name:"panel",components:{ckeditor:X.a.component,VueCropper:G.a,Multiselect:Z["a"]},data:()=>({select:null,description:"",title:"",content:"",author:"",selected_file:null,imgSrc:"",tags:[],cities:[],countries:[],opt_tags:[],opt_cities:[],opt_countries:[],s_tags:[],s_cities:[],s_countries:[],r_tags:[],r_cities:[],r_countries:[],msg:[],toast:Object(J["c"])(),markers:[],marker_id:1,latLang:[],LegPoints:[],directionsService:new google.maps.DirectionsService,_directionsRenderer:new google.maps.DirectionsRenderer,bounds:new google.maps.LatLngBounds,mapOptions:{center:{lat:35,lng:100.644},zoomControl:!0,zoom:3,gestureHandling:"auto"},editorConfig:{toolbar:{items:["heading","|","bold","italic","link","bulletedList","numberedList","|","outdent","indent","|","imageUpload","blockQuote","insertTable","mediaEmbed","undo","redo"]},language:"ru",image:{toolbar:["imageTextAlternative","imageStyle:alignLeft","imageStyle:inLine","imageStyle:alignRight","toggleImageCaption","imageStyle:alignCenter","imageStyle:centeredImage"]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"]},simpleUpload:{uploadUrl:(void 0).$store.state.backendUrl+"api/v1/upload_img/none/"}},editor:z.a}),created(){this.author=this.$store.state.cuser.id,this.loadListTags(),this.loadListCities(),this.loadListCountries()},mounted(){this.initMap()},watch:{content(e){this.content=e,this.validateContent(e)},description(e){this.description=e,this.validateDescription(e)},title(e){this.title=e,this.validateTitle(e)}},methods:{cropImage(){this.selected_file=this.$refs.cropper.getCroppedCanvas().toDataURL()},flipX(){const e=this.$refs.flipX;let t=e.getAttribute("data-scale");t=t?-t:-1,this.$refs.cropper.scaleX(t),e.setAttribute("data-scale",t)},flipY(){const e=this.$refs.flipY;let t=e.getAttribute("data-scale");t=t?-t:-1,this.$refs.cropper.scaleY(t),e.setAttribute("data-scale",t)},reset(){this.$refs.cropper.reset()},rotate(e){this.$refs.cropper.rotate(e)},setImage(e){const t=e.target.files[0];if(-1!==t.type.indexOf("image/"))if("function"===typeof FileReader){const e=new FileReader;e.onload=e=>{this.imgSrc=e.target.result,this.$refs.cropper.replace(e.target.result)},e.readAsDataURL(t)}else this.toast.error("Вибачте, FileReader API не підтримується");else this.toast.warning("Оберіть фото або файл")},showFileChooser(){this.$refs.input.click()},zoom(e){this.$refs.cropper.relativeZoom(e)},onFileSelected(e){this.selected_file=e.target.files[0]},goTo(e){this.$router.push({name:"cabinet",params:{slug:e}})},async loadListTags(){A()({url:this.$store.state.backendUrl+"api/v1/tags?limit=100&search=",method:"GET",headers:{"Content-type":"application/json"}}).then(e=>{for(var t in this.tags=e.data,e.data)this.opt_tags.push(e.data[t].name)})},async loadListCities(){A()({url:this.$store.state.backendUrl+"api/v1/city?limit=100&search=",method:"GET",headers:{"Content-type":"application/json"}}).then(e=>{for(var t in this.cities=e.data,e.data)this.opt_cities.push(e.data[t].title)})},async loadListCountries(){A()({url:this.$store.state.backendUrl+"api/v1/country?limit=100&search=",method:"GET",headers:{"Content-type":"application/json"}}).then(e=>{for(var t in this.countries=e.data,e.data)this.opt_countries.push(e.data[t].title)})},validateContent(e){let t=500-e.length;e.length<500?this.msg["content"]="Повинно бути 500 символів! "+t+" залишилось символів":this.msg["content"]=""},validateDescription(e){let t=100-e.length,o=e.length-255;e.length<100?this.msg["description"]="Повинно бути 100 символів! "+t+"залишилось символів":e.length>255?this.msg["description"]="Повинно бути не більше 255 символів! "+o+" зайвих символів":this.msg["description"]=""},validateTitle(e){let t=e.length-255;e.length>255?this.msg["title"]="Повинно бути не більше 255 символів! "+t+" зайвих символів":this.msg["title"]=""},create:function(){if(this.msg["content"]||this.msg["description"])this.toast.error("Відбулася помилка. Введіть валідні данні або спробуйте пізніше ");else{for(var e in this.s_cities)this.r_cities.push(this.cities.find(t=>t.title===this.s_cities[e]).slug);for(var e in this.s_countries)this.r_countries.push(this.countries.find(t=>t.title===this.s_countries[e]).slug);for(var e in this.s_tags)this.r_tags.push(this.tags.find(t=>t.name===this.s_tags[e]).slug);const t=new FormData;t.append("title",this.title),t.append("author_id",this.author),t.append("content",this.content),t.append("content",this.content);for(let e in this.r_cities)t.append("city",this.r_cities[e]);for(let e in this.r_tags)t.append("tags",this.r_tags[e]);for(let e in this.r_countries)t.append("country",this.r_countries[e]);t.append("description",this.description),t.append("img",this.selected_file),A()({url:this.$store.state.backendUrl+"api/v1/create",data:t,method:"POST"}).then(e=>{for(var t in console.log(e),this.markers){const o=new FormData;o.append("lng",Number(String(this.markers[t].getPosition().lng()).slice(0,15))),o.append("lat",Number(String(this.markers[t].getPosition().lat()).slice(0,15))),A()({url:this.$store.state.backendUrl+"api/v1/add_point/"+e.data.slug,data:o,method:"POST"}).then(e=>{console.log(e)}),console.log(Number(String(this.markers[t].getPosition().lng()).slice(0,15))),console.log(Number(String(this.markers[t].getPosition().lat()).slice(0,15)))}let o=this.$router.resolve({name:"blog"});window.location.assign(o.href)}).catch(e=>{this.toast.error("Відбулася помилка. Введіть валідні данні або спробуйте пізніше ")})}},getRoutePointsAndWaypoints(e,t){this.drawRoutePointsAndWaypoints(e,t)},drawRoute(e,t,o,i){var s="";s=o.length>0?{origin:e,destination:t,waypoints:o,optimizeWaypoints:!0,travelMode:google.maps.DirectionsTravelMode.DRIVING}:{origin:e,destination:t,travelMode:google.maps.DirectionsTravelMode.DRIVING};var a=this;this.directionsService.route(s,(function(e,t){if(t===google.maps.DirectionsStatus.OK)a._directionsRenderer.setDirections(e);else if(t===google.maps.DirectionsStatus.ZERO_RESULTS){a.toast.error("Неможливо поставити мітку.");for(var o=0;o<a.markers.length;o++)if(a.markers[o].id===i.id)return i.setMap(null),a.markers.splice(o,1),void a.latLang.splice(o,1)}}))},drawRoutePointsAndWaypoints(e,t){var o=new Array;if(e.length>2){for(var i=1;i<e.length-1;i++){var s=e[i];""!==s&&o.push({location:s,stopover:!0})}this.drawRoute(e[0],e[e.length-1],o,t)}else e.length>1?this.drawRoute(e[this.latLang.length-2],e[e.length-1],o,t):this.drawRoute(e[this.latLang.length-1],e[e.length-1],o,t)},placeMarker(e,t){return t.id=this.marker_id,this.marker_id++,this.markers.push(t),t},initMap(){const e=new google.maps.Map(this.$refs.googleMap,{...this.mapOptions});this._directionsRenderer.setMap(e),this._directionsRenderer.setOptions({draggable:!0,suppressMarkers:!0});var t=this;google.maps.event.addListener(e,"click",(function(o){var i=new google.maps.Marker({position:o.latLng,map:e});t.latLang.push(o.latLng),t.LegPoints.push(""),t.LegPoints.push(""),t.placeMarker(e,i);i.id;t.getRoutePointsAndWaypoints(t.latLang,i),google.maps.event.addListener(i,"click",(function(e){for(var o=0;o<t.markers.length;o++)if(t.markers[o].id===i.id)return i.setMap(null),t.markers.splice(o,1),void t.latLang.splice(o,1)}))})),google.maps.event.addListener(this._directionsRenderer,"directions_changed",(function(){var t=this._directionsRenderer.directions.routes[0];CreateRoute(t),e.getZoom()}))}}},H=(o("d742"),o("2f20"),o("d959")),K=o.n(H);const Q=K()(q,[["render",I]]);t["default"]=Q},aae2:function(e,t,o){}}]);
//# sourceMappingURL=chunk-59dbd6b8.ea89bf91.js.map