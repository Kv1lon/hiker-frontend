"use strict";(self["webpackChunkhiker"]=self["webpackChunkhiker"]||[]).push([[202],{2202:function(t,e,s){s.r(e),s.d(e,{default:function(){return ot}});var a=s(6252),o=s(6612),i=s(8061);const n=t=>((0,a.dD)("data-v-07df4c70"),t=t(),(0,a.Cn)(),t),l={class:"container mtb",id:"page"},r={class:"row"},d={"data-aos":"fade-in","data-aos-delay":"300",class:"col-lg-10"},c=["src"],u={class:"ctitle"},h={key:0},m=(0,a.Uk)("Не подобається "),p=(0,a.Uk)("Подобається "),g=(0,a.Uk)(" | "),f=["innerHTML"],_=(0,a.uE)('<div class="spacing" data-v-07df4c70></div><h6 data-v-07df4c70>SHARE:</h6><p class="share" data-v-07df4c70><a href="#" data-v-07df4c70><i class="fa fa-twitter" data-v-07df4c70></i></a><a href="#" data-v-07df4c70><i class="fa fa-facebook" data-v-07df4c70></i></a><a href="#" data-v-07df4c70><i class="fa fa-tumblr" data-v-07df4c70></i></a><a href="#" data-v-07df4c70><i class="fa fa-google-plus" data-v-07df4c70></i></a></p>',3),v={"data-aos":"slide-right","data-aos-delay":"100",class:"col-lg-2"},k={class:"blog_right_sidebar"},w={key:0,class:"single_sidebar_widget author_widget"},y=["src"],b=n((()=>(0,a._)("div",{class:"br"},null,-1))),P=n((()=>(0,a._)("div",{class:"hline"},null,-1))),z=n((()=>(0,a._)("h4",null,"Популярні пости",-1))),U={class:"popular-posts"},D=["onClick"],R=["src"],W={href:""},$=(0,a.Uk)(),L=n((()=>(0,a._)("div",{class:"hline"},null,-1))),M={"data-aos":"zoom-in","data-aos-delay":"500",ref:"googleMap",class:"google-map"},S={key:0,"data-aos":"zoom-in","data-aos-delay":"500",class:"row"},C={class:"col-md-4"},T=n((()=>(0,a._)("h4",null,"Залиште коментар",-1))),x=n((()=>(0,a._)("div",{class:"form-group form-inline"},null,-1))),H={class:"form-group"},A=n((()=>(0,a._)("button",{type:"submit",class:"btn btn-info"},"Відправити",-1))),E={class:"title-comments"},O={"data-aos":"fade-in","data-aos-delay":"500",class:"media-list"},G={class:"media"},I=["src"],q={class:"media-body"},N={class:"media-heading"},j={class:"author"},F={class:"metadata"},K={class:"date"},V={class:"media-text text-justify"};function Y(t,e,s,n,Y,Z){const B=(0,a.up)("font-awesome-icon"),J=(0,a.up)("csmall"),Q=(0,a.up)("csmall2");return(0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("div",r,[(0,a._)("div",d,[(0,a._)("p",null,[(0,a._)("img",{class:"img-responsive",style:{width:"100%"},src:t.Post.img},null,8,c)]),(0,a._)("h3",u,(0,o.zw)(t.Post.title),1),t.user.username?((0,a.wg)(),(0,a.iD)("div",h,["like"===t.like_status?((0,a.wg)(),(0,a.iD)("div",{key:0,style:{cursor:"pointer",color:"#ffffff","font-weight":"bold"},class:"btn btn-danger",onClick:e[0]||(e[0]=(...t)=>Z.Unlike&&Z.Unlike(...t))},[m,(0,a.Wm)(B,{size:"x",icon:["fas","heart"]})])):(0,a.kq)("",!0),"unlike"===t.like_status?((0,a.wg)(),(0,a.iD)("div",{key:1,style:{cursor:"pointer",color:"#ffffff","font-weight":"bold"},class:"btn btn-primary",onClick:e[1]||(e[1]=(...t)=>Z.Like&&Z.Like(...t))},[p,(0,a.Wm)(B,{size:"  x",icon:["far","heart"]})])):(0,a.kq)("",!0)])):(0,a.kq)("",!0),(0,a._)("p",null,[(0,a.Wm)(J,null,{default:(0,a.w5)((()=>[(0,a.Wm)(B,{icon:["far","clock"]}),(0,a.Uk)(" "+(0,o.zw)(t.Post.date),1)])),_:1}),g,(0,a.Wm)(Q,null,{default:(0,a.w5)((()=>[(0,a.Wm)(B,{icon:["far","user"]}),(0,a.Uk)((0,o.zw)(t.Post.author)+" ",1),(0,a.Wm)(B,{icon:["far","comment"]}),(0,a.Uk)((0,o.zw)(t.comments_count)+" ",1),(0,a.Wm)(B,{icon:["far","heart"]}),(0,a.Uk)((0,o.zw)(t.likes_count)+" ",1),(0,a.Wm)(B,{icon:["far","eye"]}),(0,a.Uk)((0,o.zw)(t.Post.views),1)])),_:1})]),(0,a._)("div",{class:"post-content",innerHTML:t.Post.content},null,8,f),_]),(0,a._)("div",v,[(0,a._)("div",k,[t.user.username?((0,a.wg)(),(0,a.iD)("aside",w,[(0,a._)("img",{src:t.user.profile_img,alt:"Admin",class:"rounded-circle profile_img"},null,8,y),(0,a._)("h4",null,(0,o.zw)(t.user.username),1),(0,a._)("p",null,(0,o.zw)(t.user.email),1),b])):(0,a.kq)("",!0)]),P,z,(0,a._)("ul",U,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.popular,(t=>((0,a.wg)(),(0,a.iD)("li",{class:"popular-post","data-aos":"zoom-in",key:t.id,onClick:e=>Z.goTo(t.slug)},[(0,a._)("a",null,[(0,a._)("img",{style:{height:"9vh"},src:t.img},null,8,R)]),(0,a._)("p",null,[(0,a._)("a",W,(0,o.zw)(t.title),1)]),(0,a._)("em",null,[(0,a.Wm)(B,{icon:["far","clock"]}),(0,a.Uk)(" "+(0,o.zw)(t.date)+" ",1),(0,a._)("div",null,[(0,a.Wm)(B,{icon:["far","user"]}),(0,a.Uk)((0,o.zw)(t.author),1)]),$,(0,a.Wm)(B,{icon:["far","comment"]}),(0,a.Uk)((0,o.zw)(t.comments.length)+" ",1),(0,a.Wm)(B,{icon:["far","heart"]}),(0,a.Uk)((0,o.zw)(t.likes.length)+" ",1),(0,a.Wm)(B,{icon:["far","eye"]}),(0,a.Uk)((0,o.zw)(t.views),1)])],8,D)))),128))]),L])]),(0,a.wy)((0,a._)("div",M,null,512),[[i.F8,t.map]]),t.user.username?((0,a.wg)(),(0,a.iD)("div",S,[(0,a._)("div",C,[T,(0,a._)("form",{onSubmit:e[3]||(e[3]=(0,i.iM)(((...t)=>Z.create&&Z.create(...t)),["prevent"])),class:"comment-form"},[x,(0,a._)("div",H,[(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":e[2]||(e[2]=e=>t.content=e),class:"form-control mb-10",rows:"5",name:"text",placeholder:"Комментарий",onfocus:"this.placeholder = ''",onblur:"this.placeholder = 'Комментарий'"},null,512),[[i.nr,t.content]])]),A],32)])])):(0,a.kq)("",!0),(0,a._)("h3",E,"Комментарі ("+(0,o.zw)(t.comments_count)+")",1),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.Post.comments,(t=>((0,a.wg)(),(0,a.iD)("ul",O,[(0,a._)("li",G,[(0,a._)("img",{class:"media-object img-rounded",src:"http://127.0.0.1:8000"+t.author.profile_img,alt:""},null,8,I),(0,a._)("div",q,[(0,a._)("div",N,[(0,a._)("div",j,(0,o.zw)(t.author.username),1),(0,a._)("div",F,[(0,a._)("span",K,(0,o.zw)(t.created_date),1)])]),(0,a._)("div",V,(0,o.zw)(t.text),1)])])])))),256))])}var Z=s(9669),B=s.n(Z),J=s(7810),Q=s(1436),X=s(8947),tt=s(3002);X.vI.add(Q.m6i);var et={name:"post_page",props:["slug"],components:{"font-awesome-icon":J.GN},data:()=>({Post:[],user:{},content:"",like_status:"",comments_count:"",selected_file:null,tags_count:"",likes_count:"",popular:[],toast:(0,tt.pm)(),markers:[],marker_id:1,latLang:[],LegPoints:[],map:null,directionsService:new google.maps.DirectionsService,_directionsRenderer:new google.maps.DirectionsRenderer,bounds:new google.maps.LatLngBounds,mapOptions:{center:{lat:35,lng:100.644},zoomControl:!0,zoom:3,gestureHandling:"auto"},status:"ok"}),created(){this.loadPost(),this.loadPopularPosts(),this.user=this.$store.state.cuser,window.addEventListener("scroll",this.handleScroll)},destroyed(){window.removeEventListener("scroll",this.handleScroll)},methods:{async loadPost(){B()({url:`${this.$store.getters.getServerUrl}api/v1/blog/${this.slug}`,method:"GET",headers:{"Content-type":"application/json"}}).then((t=>{this.Post=t.data,this.comments_count=t.data.comments.length,this.tags_count=t.data.tags.length,this.likes_count=t.data.likes.length,t.data.likes.includes(this.$store.state.cuser.username)?this.like_status="like":this.like_status="unlike",0!==t.data.waypoints.length&&(this.map=new google.maps.Map(this.$refs.googleMap,{center:{lat:35,lng:100.644},zoomControl:!0,zoom:3,gestureHandling:"auto"}),this.initMap(t))})).catch((t=>{console.log(t)}))},async Like(){const t=new FormData;t.append("id",this.$store.state.cuser.id),B()({url:this.$store.state.backendUrl+`api/v1/like/${this.Post.id}`,data:t,method:"POST"}).then((t=>{this.loadPost()}))},async Unlike(){const t=new FormData;t.append("id",this.$store.state.cuser.id),B()({url:this.$store.state.backendUrl+`api/v1/unlike/${this.Post.id}`,data:t,method:"POST"}).then((t=>{this.loadPost()}))},create:function(){const t=new FormData;t.append("author_id",this.user.id),t.append("text",this.content),B()({url:this.$store.state.backendUrl+`api/v1/comment_create/${this.slug}`,data:t,method:"POST"}).then((t=>{this.content="",this.toast.success("Комментарий создан и отправлен на рассмотрение")})).catch((t=>this.toast.error("Произошла ошибка: "+t)))},async loadPopularPosts(){B()({url:this.$store.state.backendUrl+"api/v1/blog?limit=3&search=&date=month&ordering=descending",method:"GET",headers:{"Content-type":"application/json"}}).then((t=>{this.popular=t.data.results}))},goTo(t){this.$router.push({name:"post",params:{slug:t}})},getRoutePointsAndWaypoints(t){this.drawRoutePointsAndWaypoints(t)},drawRoute(t,e,s){var a="";a=s.length>0?{origin:t,destination:e,waypoints:s,optimizeWaypoints:!0,travelMode:google.maps.DirectionsTravelMode.DRIVING}:{origin:t,destination:e,travelMode:google.maps.DirectionsTravelMode.DRIVING};var o=this;this.directionsService.route(a,(function(t,e){e==google.maps.DirectionsStatus.OK&&o._directionsRenderer.setDirections(t)}))},drawRoutePointsAndWaypoints(t){var e=new Array;if(t.length>2){for(var s=1;s<t.length-1;s++){var a=t[s];""!==a&&e.push({location:a,stopover:!0})}this.drawRoute(t[0],t[t.length-1],e)}else t.length>1?this.drawRoute(t[this.latLang.length-2],t[t.length-1],e):this.drawRoute(t[this.latLang.length-1],t[t.length-1],e)},placeMarker(t,e){return e.id=this.marker_id,this.marker_id++,this.markers.push(e),e},initMap(t){this._directionsRenderer.setMap(this.map),this._directionsRenderer.setOptions({draggable:!0,suppressMarkers:!0});var e=this;for(var s in t.data.waypoints){var a={lat:Number(t.data.waypoints[s].lat),lng:Number(t.data.waypoints[s].lng)};let o=new google.maps.Marker({position:a,map:this.map});e.latLang.push(a),e.LegPoints.push(""),e.getRoutePointsAndWaypoints(e.latLang),e.placeMarker(this.map,o);o.id}google.maps.event.addListener(this._directionsRenderer,"directions_changed",(function(){var t=this._directionsRenderer.directions.routes[0];CreateRoute(t),e.map.getZoom()}))},handleScroll(){document.body.scrollHeight/2<window.pageYOffset&&"sent"!==this.status&&B()({url:this.$store.state.backendUrl+`api/v1/add_view/${this.Post.slug}`,method:"GET"}).then(this.status="sent")}}},st=s(3744);const at=(0,st.Z)(et,[["render",Y],["__scopeId","data-v-07df4c70"]]);var ot=at}}]);
//# sourceMappingURL=202.fbe1db1c.js.map