"use strict";(self["webpackChunkhiker"]=self["webpackChunkhiker"]||[]).push([[91],{4091:function(e,t,a){a.r(t),a.d(t,{default:function(){return Re}});var i=a(6252),s=a(6612),l=a(8061);const o=e=>((0,i.dD)("data-v-ef66b1a4"),e=e(),(0,i.Cn)(),e),r={key:0,class:"preloader"},n=o((()=>(0,i._)("div",{class:"preloader__image"},null,-1))),c=[n],d={key:1,class:"container mtb"},u={class:"row"},m={class:"col-lg-8"},h={class:"buy","data-aos":"zoom-in","data-aos-delay":"300"},p={class:"ticket"},_={class:"ticket"},k={class:"ticket"},g={class:"ticket"},f={class:"ticket"},v={key:0},w={class:"ticket"},b={class:"ticket"},y={class:"ticket"},T={class:"ticket"},C={class:"buy","data-aos":"zoom-in","data-aos-delay":"300"},U={class:"ticket"},z={class:"ticket"},D={class:"ticket"},V=(0,i.Uk)(),A={class:"form-detail"},I={key:0,class:"form-row"},M=o((()=>(0,i._)("label",{for:"email"},"Email",-1))),N={key:1,class:"form-row"},S=o((()=>(0,i._)("label",{for:"phone"},"Телефон",-1))),E=o((()=>(0,i._)("span",{class:"modal__title"},[(0,i._)("h3",null,"Пошук білетів")],-1))),O={class:"modal__content"},P=o((()=>(0,i._)("div",{class:"hline"},null,-1))),W={class:""},x=o((()=>(0,i._)("h4",null,"Звідки ",-1))),L={class:"form-group"},G={class:"form-group"},R={class:"multiselect-tag is-user"},q=["onMousedown"],Y=o((()=>(0,i._)("h4",null,"Куди",-1))),$={class:"form-group"},H={class:"multiselect-tag is-user"},F=["onMousedown"],J=o((()=>(0,i._)("h4",null,"Коли",-1))),Z={class:"form-group"},B=["onClick"],j=["value"],K=o((()=>(0,i._)("h4",null,"Назад(Не обовязково)",-1))),Q={class:"form-group"},X=["onClick"],ee=["value"],te=o((()=>(0,i._)("h4",null,"Пасажиры",-1))),ae={class:"btn btn-theme"},ie=(0,i.Uk)("Дорослі "),se={class:"btn btn-theme"},le=(0,i.Uk)("Діти "),oe={class:"btn btn-theme"},re=(0,i.Uk)("Немовлята "),ne=o((()=>(0,i._)("h4",null,"Клас",-1))),ce={class:"btn btn-theme"},de=(0,i.Uk)("Эконом "),ue={class:"btn btn-theme"},me=(0,i.Uk)("Преміум-эконом "),he={class:"btn btn-theme"},pe=(0,i.Uk)("Бізнес "),_e={class:"btn btn-theme"},ke=(0,i.Uk)("Перший "),ge={"data-aos":"slide-right","data-aos-delay":"300",class:"col-lg-4"},fe={key:0,class:"single_sidebar_widget author_widget"},ve=["src"],we=o((()=>(0,i._)("div",{class:"br"},null,-1))),be=o((()=>(0,i._)("div",{class:"spacing"},null,-1))),ye={key:1},Te={class:"popular-posts"},Ce=["onClick"],Ue=["src"],ze={href:""};function De(e,t,a,o,n,De){const Ve=(0,i.up)("font-awesome-icon"),Ae=(0,i.up)("Multiselect"),Ie=(0,i.up)("v-date-picker"),Me=(0,i.up)("vue-number-input"),Ne=(0,i.up)("vue-final-modal");return e.loading?((0,i.wg)(),(0,i.iD)("div",r,c)):((0,i.wg)(),(0,i.iD)("div",d,[(0,i._)("div",u,[(0,i._)("div",m,[(0,i._)("div",h,[(0,i._)("div",p,"Дата бронювання: "+(0,s.zw)(De.format_date(e.ticket.associatedRecords.find((e=>e.creationDate)).creationDate)),1),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.ticket.flightOffers[0].itineraries[0].segments,(t=>((0,i.wg)(),(0,i.iD)("div",{key:e.ticket.flightOffers[0].id},[(0,i._)("div",_,"Звідки: "+(0,s.zw)(t.departure.iataCode),1),(0,i._)("h4",k,"Відїзд: "+(0,s.zw)(De.format_date(t.departure.at)),1),(0,i._)("div",g,"Куди: "+(0,s.zw)(t.arrival.iataCode),1),(0,i._)("h4",f,"Прибуття: "+(0,s.zw)(De.format_date(t.arrival.at)),1)])))),128)),e.ticket.flightOffers[0].itineraries[1]?((0,i.wg)(),(0,i.iD)("hr",v)):(0,i.kq)("",!0),e.ticket.flightOffers[0].itineraries[1]?((0,i.wg)(!0),(0,i.iD)(i.HY,{key:1},(0,i.Ko)(e.ticket.flightOffers[0].itineraries[1].segments,(t=>((0,i.wg)(),(0,i.iD)("div",{key:e.ticket.flightOffers[0].id},[(0,i._)("div",w,"Звідки: "+(0,s.zw)(t.departure.iataCode),1),(0,i._)("h4",b,"Відїзд: "+(0,s.zw)(De.format_date(t.departure.at)),1),(0,i._)("div",y,"Куди: "+(0,s.zw)(t.arrival.iataCode),1),(0,i._)("h4",T,"Прибуття: "+(0,s.zw)(De.format_date(t.arrival.at)),1)])))),128)):(0,i.kq)("",!0)]),(0,i._)("div",C,[(0,i._)("div",null,[(0,i._)("h3",U,"Id: "+(0,s.zw)(e.ticket.travelers[e.tickets_i["tr"]].id),1),(0,i._)("h3",z,"Імя: "+(0,s.zw)(e.ticket.travelers[e.tickets_i["tr"]].name.firstName+" "+e.ticket.travelers[e.tickets_i["tr"]].name.lastName),1),(0,i._)("h3",D,"Тариф: "+(0,s.zw)(e.ticket.travelers[e.tickets_i["tr"]].contact.purpose),1)]),V,e.tickets_i["tr"]>0?((0,i.wg)(),(0,i.iD)("button",{key:0,class:"btn btn-theme",onClick:t[0]||(t[0]=(0,l.iM)((t=>e.tickets_i["tr"]--),["prevent"]))},"Минулий пасажир")):(0,i.kq)("",!0),e.tickets_i["tr"]<e.ticket.flightOffers[0].travelerPricings.length-1?((0,i.wg)(),(0,i.iD)("button",{key:1,class:"btn btn-theme",onClick:t[1]||(t[1]=(0,l.iM)((t=>e.tickets_i["tr"]++),["prevent"]))},"Наступний пасажир")):(0,i.kq)("",!0),(0,i._)("form",A,[e.ticket.travelers[e.tickets_i["tr"]].contact.emailAddress?((0,i.wg)(),(0,i.iD)("div",I,[M,(0,i.wy)((0,i._)("input",{type:"email","onUpdate:modelValue":t[2]||(t[2]=t=>e.ticket.travelers[e.tickets_i["tr"]].contact.emailAddress=t),name:"email",id:"email",readonly:"",class:"input-text",placeholder:"Email",required:""},null,512),[[l.nr,e.ticket.travelers[e.tickets_i["tr"]].contact.emailAddress]])])):(0,i.kq)("",!0),e.ticket.travelers[e.tickets_i["tr"]].contact.phones[0].number?((0,i.wg)(),(0,i.iD)("div",N,[S,(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.ticket.travelers[e.tickets_i["tr"]].contact.phones[0].number=t),type:"text",name:"phone",id:"phone",class:"input-text",readonly:"",placeholder:"Номер телефона",required:""},null,512),[[l.nr,e.ticket.travelers[e.tickets_i["tr"]].contact.phones[0].number]])])):(0,i.kq)("",!0)])]),(0,i._)("div",null,[(0,i.Wm)(Ne,{modelValue:e.show,"onUpdate:modelValue":t[19]||(t[19]=t=>e.show=t),resize:!0,"keep-changed-style":!0,"esc-to-close":!0,"resize-directions":["t","tr","r","br","b","bl","l","tl"],classes:"modal-container","content-class":"modal-content"},{default:(0,i.w5)((()=>[(0,i.Wm)(Ve,{class:"modal__close",onClick:t[4]||(t[4]=t=>e.show=!1),icon:["fas","times"]}),E,(0,i._)("div",O,[P,(0,i._)("div",W,[x,(0,i._)("div",L,[(0,i._)("div",G,[(0,i.Wm)(Ae,{"close-on-select":!0,searchable:!0,modelValue:e.orl,"onUpdate:modelValue":t[6]||(t[6]=t=>e.orl=t),options:e.op},{tag:(0,i.w5)((({option:e,handleTagRemove:a,disabled:o})=>[(0,i._)("div",R,[(0,i.Uk)((0,s.zw)(e.value)+" ",1),o?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("i",{key:0,onClick:t[5]||(t[5]=(0,l.iM)((()=>{}),["prevent"])),onMousedown:(0,l.iM)((t=>a(e,t)),["prevent","stop"])},null,40,q))])])),_:1},8,["modelValue","options"])])]),Y,(0,i._)("div",$,[(0,i.Wm)(Ae,{"close-on-select":!0,searchable:!0,modelValue:e.del,"onUpdate:modelValue":t[8]||(t[8]=t=>e.del=t),options:e.op},{tag:(0,i.w5)((({option:e,handleTagRemove:a,disabled:o})=>[(0,i._)("div",H,[(0,i.Uk)((0,s.zw)(e.value)+" ",1),o?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("i",{key:0,onClick:t[7]||(t[7]=(0,l.iM)((()=>{}),["prevent"])),onMousedown:(0,l.iM)((t=>a(e,t)),["prevent","stop"])},null,40,F))])])),_:1},8,["modelValue","options"])]),J,(0,i.Wm)(Ie,{mode:"dateTime",is24hr:!0,timezone:e.timezone,"minute-increment":5,"model-config":e.modelConfig,class:"btn",modelValue:e.forward,"onUpdate:modelValue":t[9]||(t[9]=t=>e.forward=t)},{default:(0,i.w5)((({inputValue:e,togglePopover:t})=>[(0,i._)("div",Z,[(0,i._)("button",{onClick:e=>t(),class:"form-control"},[(0,i.Wm)(Ve,{icon:["far","calendar-alt"]})],8,B),(0,i._)("input",{value:e,class:"form-control",readonly:""},null,8,j)])])),_:1},8,["timezone","model-config","modelValue"]),K,(0,i.Wm)(Ie,{mode:"dateTime",is24hr:!0,timezone:e.timezone,"minute-increment":5,"model-config":e.modelConfig,class:"btn",modelValue:e.back,"onUpdate:modelValue":t[10]||(t[10]=t=>e.back=t)},{default:(0,i.w5)((({inputValue:e,togglePopover:t})=>[(0,i._)("div",Q,[(0,i._)("button",{onClick:e=>t(),class:"form-control"},[(0,i.Wm)(Ve,{icon:["far","calendar-alt"]})],8,X),(0,i._)("input",{value:e,readonly:"",class:"form-control"},null,8,ee)])])),_:1},8,["timezone","model-config","modelValue"]),te,(0,i._)("div",ae,[ie,(0,i.Wm)(Me,{class:"form-control",modelValue:e.adult,"onUpdate:modelValue":t[11]||(t[11]=t=>e.adult=t),min:1,max:9-e.teen,controls:""},null,8,["modelValue","max"])]),(0,i._)("div",se,[le,(0,i.Wm)(Me,{class:"form-control",modelValue:e.teen,"onUpdate:modelValue":t[12]||(t[12]=t=>e.teen=t),min:0,max:9-e.adult,controls:""},null,8,["modelValue","max"])]),(0,i._)("div",oe,[re,(0,i.Wm)(Me,{class:"form-control",modelValue:e.baby,"onUpdate:modelValue":t[13]||(t[13]=t=>e.baby=t),min:0,max:e.adult,controls:""},null,8,["modelValue","max"])]),ne,(0,i._)("div",ce,[de,(0,i.wy)((0,i._)("input",{type:"radio","onUpdate:modelValue":t[14]||(t[14]=t=>e.trip_class=t),name:"popular",value:"E"},null,512),[[l.G2,e.trip_class]])]),(0,i._)("div",ue,[me,(0,i.wy)((0,i._)("input",{type:"radio","onUpdate:modelValue":t[15]||(t[15]=t=>e.trip_class=t),name:"popular",value:"PE"},null,512),[[l.G2,e.trip_class]])]),(0,i._)("div",he,[pe,(0,i.wy)((0,i._)("input",{type:"radio",name:"popular","onUpdate:modelValue":t[16]||(t[16]=t=>e.trip_class=t),value:"B"},null,512),[[l.G2,e.trip_class]])]),(0,i._)("div",_e,[ke,(0,i.wy)((0,i._)("input",{type:"radio",name:"popular","onUpdate:modelValue":t[17]||(t[17]=t=>e.trip_class=t),value:"F"},null,512),[[l.G2,e.trip_class]])]),(0,i._)("div",null,[(0,i._)("button",{onClick:t[18]||(t[18]=(...e)=>De.searchTickets&&De.searchTickets(...e)),class:"btn btn-block btn-success"},"Знайти білети")])])])])),_:1},8,["modelValue"])])]),(0,i._)("div",ge,[(0,i._)("button",{onClick:t[20]||(t[20]=(0,l.iM)((t=>e.show=!0),["prevent"])),class:"find-tickets-btn btn btn-primary"},"Знайти білети"),e.user.username?((0,i.wg)(),(0,i.iD)("aside",fe,[(0,i._)("img",{src:e.user.profile_img,alt:"Admin",class:"img-rounded rounded-circle profile_img"},null,8,ve),(0,i._)("h4",null,(0,s.zw)(e.user.username),1),(0,i._)("p",null,(0,s.zw)(e.user.email),1),we])):(0,i.kq)("",!0),be,e.popular[0]?((0,i.wg)(),(0,i.iD)("h3",ye,"Популярні пости")):(0,i.kq)("",!0),(0,i._)("ul",Te,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.popular,(e=>((0,i.wg)(),(0,i.iD)("li",{"data-aos":"zoom-in",class:"popular-post",key:e.id,onClick:(0,l.iM)((t=>De.goTo("post",{slug:e.slug})),["prevent"])},[(0,i._)("img",{style:{height:"8vh"},src:e.img},null,8,Ue),(0,i._)("p",null,[(0,i._)("a",ze,(0,s.zw)(e.title),1)]),(0,i._)("em",null,[(0,i.Wm)(Ve,{icon:["far","clock"]}),(0,i.Uk)(" "+(0,s.zw)(e.date)+" ",1),(0,i._)("div",null,[(0,i.Wm)(Ve,{icon:["far","user"]}),(0,i.Uk)((0,s.zw)(e.author),1)]),(0,i.Wm)(Ve,{icon:["far","comment"]}),(0,i.Uk)((0,s.zw)(e.comments.length)+" ",1),(0,i.Wm)(Ve,{icon:["far","heart"]}),(0,i.Uk)((0,s.zw)(e.likes.length)+" ",1),(0,i.Wm)(Ve,{icon:["far","eye"]}),(0,i.Uk)((0,s.zw)(e.views),1)])],8,Ce)))),128))])])])]))}var Ve=a(7810),Ae=a(3633),Ie=a(7939),Me=a(3002),Ne=a(5149),Se=a.n(Ne),Ee=a(4355),Oe=a.n(Ee),Pe=a(9669),We=a.n(Pe),xe={props:["slug"],name:"ticket_single",inheritAttrs:!1,emits:["confirm","cancel"],components:{"font-awesome-icon":Ve.GN,Multiselect:Ae.Z,VueNumberInput:Ie.Z},data:()=>({listPosts:[],popular:[],user:{},total:0,date:"",adult:1,teen:0,baby:0,forward:"",back:"",reqs:[],tickets_i:{it:0,fl:0,tr:0},trip_class:"",timezone:"UTC",traveler_id:1,modelConfig:{type:"string",mask:"YYYY-MM-DD hh:mm:ss",timeAdjust:"24:00:00"},show:!1,orl:"",del:"",op:{},arar:{},ticket:{},travalerType:{ADULT:"Дорослий",CHILD:"Дитина",SENIOR:"Поважного віку",YOUNG:"Молодий",HELD_INFANT:"Немовля",SEATED_INFANT:"Сидяче немовля",STUDENT:"Ученик"},fareType:{STANDARD:"Стандарт",INCLUSIVE_TOUR:"Інклюзивний тур",ADULT_WITH_COMPANION:"Дорослий із супутником",COMPANION:"Супутник"},travelers_info:[],toast:(0,Me.pm)(),loading:!1}),created(){this.loading=!0,this.loadTicket(),this.loadPopularPosts(),this.user=this.$store.state.cuser;var e=this.loadCsv(Se());this.arar,this.op=e},mounted(){console.log(this.$store.state)},methods:{loadCsv(e){for(var t=[],a=Oe().join(""),i=1;i<e.length;i++)if(a.includes(e[i][0])){for(var s="",l=0;l<e[i].length-2;l++)s+=e[i][l]+" ";e[i].push(s),t.push(s)}return e.shift(),t},async loadPopularPosts(){await We()({url:this.$store.state.backendUrl+"api/v1/blog?limit=3&search=&date=month&ordering=descending",method:"GET",headers:{"Content-type":"application/json"}}).then((e=>{this.popular=e.data.results}))},async loadTicket(){var e,t,a="grant_type=client_credentials&client_id=JxlnVpGLZUn7fV3UPNYfT2IJc0lL1GbE&client_secret=t965p0PRI1cCBS9h",i=localStorage.getItem("access");i&&delete We().defaults.headers.common["Authorization"],await We()({url:"https://test.api.amadeus.com/v1/security/oauth2/token",data:a,method:"POST",headers:{"Content-type":"application/x-www-form-urlencoded"}}).then((t=>{e=t.data.token_type+" "+t.data.access_token}));var s=`${this.$store.getters.getServerUrl}api/v1/ticket/${this.slug}`;await We()({url:s,method:"GET",headers:{Authorization:"JWT "+localStorage.getItem("access")}}).then((e=>{t=e.data.text_id,console.log(e)})),await We()({url:`https://test.api.amadeus.com/v1/booking/flight-orders/${t}`,method:"GET",headers:{Authorization:e}}).then((e=>{this.ticket=e.data.data,this.loading=!1,console.log(e)}))},async searchTickets(){var e,t="grant_type=client_credentials&client_id=JxlnVpGLZUn7fV3UPNYfT2IJc0lL1GbE&client_secret=t965p0PRI1cCBS9h",a=localStorage.getItem("access");a&&delete We().defaults.headers.common["Authorization"],this.loading=!0,await We()({url:"https://test.api.amadeus.com/v1/security/oauth2/token",data:t,method:"POST",headers:{"Content-type":"application/x-www-form-urlencoded"}}).then((t=>{console.log(t),e=t.data.token_type+" "+t.data.access_token})),this.orl=this.orl.slice(0,3),this.del=this.del.slice(0,3);this.forward.toString().slice(10);var i={id:1,originLocationCode:this.orl,destinationLocationCode:this.del,departureDateTimeRange:{date:this.forward.slice(0,10),time:this.forward.slice(11)}};if(this.back[0])var s={id:2,originLocationCode:this.del,destinationLocationCode:this.orl,departureDateTimeRange:{date:this.back.slice(0,10),time:this.back.slice(11)}},l=[i,s];else l=[i];for(var o=[],r=0,n=0;n<this.adult;n++)r++,o.push({id:r,travelerType:"ADULT"});for(n=0;n<this.teen;n++)r++,o.push({id:r,travelerType:"CHILD"});for(n=0;n<this.baby;n++)r++,n<this.adult&&o.push({id:r,travelerType:"HELD_INFANT",associatedAdultId:n+1});var c="";"E"===this.trip_class?c="ECONOMY":"PE"===this.trip_class?c="PREMIUM_ECONOMY":"B"===this.trip_class?c="BUSINESS":"F"===this.trip_class&&(c="FIRST");var d={currencyCode:"USD",originDestinations:l,travelers:o,sources:["GDS"],searchCriteria:{maxFlightOffers:20,flightFilters:{cabinRestrictions:[{cabin:c,coverage:"MOST_SEGMENTS",originDestinationIds:["1"]}],carrierRestrictions:{excludedCarrierCodes:["AA","TP","AZ"]}}}},u=this;await We()({url:"https://test.api.amadeus.com/v2/shopping/flight-offers",data:d,method:"POST",headers:{Authorization:e}}).then((e=>{e.data.data[0]?(t=e.data.data,this.loading=!1,t=e.data.data,console.log(this.$store.state),this.$store.dispatch("tickets_arr",{data:t}),this.goTo("tickets")):(u.toast.error("Немає білетів"),this.loading=!1)})).catch((e=>{console.log(e),u.toast.error("Введіть валідні данні або спробуйте пізніше"),this.loading=!1})),console.log(this.$store.state.tickets),a=localStorage.getItem("access"),a&&(We().defaults.headers.common["Authorization"]="JWT "+a)},goTo(e,t){let a=this.$router.resolve({name:e,params:t});window.location.assign(a.href)},format_date(e){return e.includes("-")?e.slice(0,10).replaceAll("-",".")+" "+e.slice(11,16):e.includes("P")?e.replaceAll("P","").replaceAll("T","").replaceAll("D"," день(днів) ").replaceAll("H"," год. ").replaceAll("M"," хвилин(а) "):void 0},next_flight(e){this.tickets_i["fl"]<e.flightOffers[0].itineraries[this.tickets_i["it"]].segments.length-1?this.tickets_i["fl"]++:this.tickets_i["fl"]>=e.itineraries[this.tickets_i["it"]].segments.length-1&&this.tickets_i["it"]<e.itineraries.length-1&&(this.tickets_i["it"]++,this.tickets_i["fl"]=0)},prev_flight(e){this.tickets_i["fl"]>0?this.tickets_i["fl"]--:0===this.tickets_i["fl"]&&this.tickets_i["it"]>0&&(this.tickets_i["it"]--,this.tickets_i["fl"]=e.itineraries[this.tickets_i["it"]].segments.length-1)}}},Le=a(3744);const Ge=(0,Le.Z)(xe,[["render",De],["__scopeId","data-v-ef66b1a4"]]);var Re=Ge}}]);
//# sourceMappingURL=91.b6db74fc.js.map