(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e3002df8"],{"0948":function(e,t,l){"use strict";l("3e96")},"383e":function(e,t,l){"use strict";l.r(t);var a=l("7a23");const s=e=>(Object(a["pushScopeId"])("data-v-49180319"),e=e(),Object(a["popScopeId"])(),e),o={key:0,class:"preloader"},c=s(()=>Object(a["createElementVNode"])("div",{class:"preloader__image"},null,-1)),i=[c],r={"data-aos":"fade-in","data-aos-delay":"300",class:"edit-profile"},n={class:"container"},d=s(()=>Object(a["createElementVNode"])("div",{class:"section-header"},[Object(a["createElementVNode"])("h2",{class:"profile_text"},"Зміна профіля")],-1)),m={class:"container"},b={class:"main-body"},p={class:"row gutters-sm"},h={class:"col-md-4 mb-3"},u={class:"card"},g={class:"card-body"},j={class:"d-flex flex-column align-items-center text-center"},O=["src"],f={key:1,src:"https://secure.gravatar.com/avatar/c9877cc06c704dbe1dd3d4f305cb22d6?s=650&d=mm&r=g",style:{"border-radius":"100px"},alt:"Admin",class:"rounded-circle",width:"150"},V={class:"mt-3"},E={class:"profile_text"},v=["innerHTML"],N={class:"text-muted font-size-sm profile_text"},y=s(()=>Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("label",{for:"upload_pr",class:"btn btn-success"},"Завантажити фото")],-1)),k={key:1,class:"content"},_={class:"cropper-area"},w={class:"img-cropper"},C={class:"preview-area"},x=s(()=>Object(a["createElementVNode"])("label",null,"Обрізати фото",-1)),$={class:"cropped-image"},U=["src"],B={key:1,class:"crop-placeholder"},S=Object(a["createTextVNode"])(),T={class:"col-md-8"},I={class:"card mb-3"},L={class:"card-body"},M={class:"row profile_text"},A=s(()=>Object(a["createElementVNode"])("div",{class:"col-sm-3"},[Object(a["createElementVNode"])("h6",{lass:"mb-0"},"Імя")],-1)),D={class:"col-sm-9 text-secondary p"},R=s(()=>Object(a["createElementVNode"])("hr",null,null,-1)),F={class:"row profile_text"},P=s(()=>Object(a["createElementVNode"])("div",{class:"col-sm-3"},[Object(a["createElementVNode"])("h6",{class:"mb-0"},"Email")],-1)),X={class:"col-sm-9 text-secondary"},Y={key:0},q=s(()=>Object(a["createElementVNode"])("hr",null,null,-1)),z={class:"row profile_text"},G=s(()=>Object(a["createElementVNode"])("div",{class:"col-sm-3"},[Object(a["createElementVNode"])("h6",{class:"mb-0"},"Адреса")],-1)),H={class:"col-sm-9 text-secondary"},J=s(()=>Object(a["createElementVNode"])("hr",null,null,-1)),Q={class:"row profile_text"},Z=s(()=>Object(a["createElementVNode"])("div",{class:"col-sm-3"},[Object(a["createElementVNode"])("h6",{class:"mb-0"},"Улюблене")],-1)),K={class:"col-sm-9 text-secondary"},W=s(()=>Object(a["createElementVNode"])("hr",null,null,-1)),ee={class:"row profile_text"},te=s(()=>Object(a["createElementVNode"])("div",{class:"col-sm-3"},[Object(a["createElementVNode"])("h6",{class:"mb-0"},"Біо")],-1)),le={class:"col-sm-9 text-secondary"},ae=s(()=>Object(a["createElementVNode"])("hr",null,null,-1));function se(e,t,l,s,c,se){const oe=Object(a["resolveComponent"])("vue-cropper"),ce=Object(a["resolveComponent"])("Multiselect"),ie=Object(a["resolveComponent"])("ckeditor");return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[e.loading?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",o,i)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("div",{style:Object(a["normalizeStyle"])({"background-image":"url("+e.user_region.background_img+")",backgroundSize:"100%"})},[Object(a["createElementVNode"])("section",r,[Object(a["createElementVNode"])("div",n,[d,Object(a["createElementVNode"])("div",m,[Object(a["createElementVNode"])("div",b,[Object(a["createElementVNode"])("div",p,[Object(a["createElementVNode"])("div",h,[Object(a["createElementVNode"])("div",u,[Object(a["createElementVNode"])("div",g,[Object(a["createElementVNode"])("div",j,[e.user.profile_img?(Object(a["openBlock"])(),Object(a["createElementBlock"])("img",{key:0,src:e.user.profile_img,style:{"border-radius":"100px"},alt:"Admin",class:"rounded-circle",width:"150"},null,8,O)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("img",f)),Object(a["createElementVNode"])("div",V,[Object(a["createElementVNode"])("h4",E,Object(a["toDisplayString"])(e.user.username),1),e.user.bio?(Object(a["openBlock"])(),Object(a["createElementBlock"])("p",{key:0,class:"text-secondary mb-1 profile_text",innerHTML:e.user.bio},null,8,v)):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("p",N,Object(a["toDisplayString"])(e.city),1),Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("button",{class:"btn btn-dark",onClick:t[0]||(t[0]=(...e)=>se.resetPassword&&se.resetPassword(...e))},"Змінити пароль")]),y,Object(a["createElementVNode"])("input",{ref:"input",type:"file",name:"image",accept:"image/*",onChange:t[1]||(t[1]=(...e)=>se.setImage&&se.setImage(...e)),id:"upload_pr"},null,544),""!==e.imgSrc?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",k,[Object(a["createElementVNode"])("section",_,[Object(a["createElementVNode"])("div",w,[Object(a["createVNode"])(oe,{style:{"max-height":"40vh",display:"block"},ref:"cropper","aspect-ratio":1,src:e.imgSrc,preview:".preview"},null,8,["src"])]),Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("a",{href:"#",role:"button",class:"btn btn-theme",onClick:t[2]||(t[2]=Object(a["withModifiers"])(e=>se.rotate(-90),["prevent"]))}," Повернути "),Object(a["createElementVNode"])("a",{ref:"flipX",href:"#",role:"button",class:"btn btn-theme",onClick:t[3]||(t[3]=Object(a["withModifiers"])((...e)=>se.flipX&&se.flipX(...e),["prevent"]))}," Відзеркалити по горизонгталі ",512),Object(a["createElementVNode"])("a",{ref:"flipY",href:"#",role:"button",class:"btn btn-theme",onClick:t[4]||(t[4]=Object(a["withModifiers"])((...e)=>se.flipY&&se.flipY(...e),["prevent"]))}," Відзеркилити по вертикалі ",512),Object(a["createElementVNode"])("a",{href:"#",role:"button",class:"btn btn-theme",onClick:t[5]||(t[5]=Object(a["withModifiers"])((...e)=>se.cropImage&&se.cropImage(...e),["prevent"]))}," Обрізати "),Object(a["createElementVNode"])("a",{href:"#",role:"button",class:"btn btn-theme",onClick:t[6]||(t[6]=Object(a["withModifiers"])((...e)=>se.reset&&se.reset(...e),["prevent"]))}," Скасувати ")])]),Object(a["createElementVNode"])("section",C,[x,Object(a["createElementVNode"])("div",$,[e.selected_file?(Object(a["openBlock"])(),Object(a["createElementBlock"])("img",{key:0,style:{"max-height":"40vh",display:"block","border-style":"groove"},src:e.selected_file,alt:"Cropped Image"},null,8,U)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",B))])])])):Object(a["createCommentVNode"])("",!0),S,Object(a["createElementVNode"])("button",{onClick:t[7]||(t[7]=(...e)=>se.update&&se.update(...e)),class:"btn btn-primary"},"Зберегти")])])])])]),Object(a["createElementVNode"])("div",T,[Object(a["createElementVNode"])("div",I,[Object(a["createElementVNode"])("div",L,[Object(a["createElementVNode"])("div",M,[A,Object(a["createElementVNode"])("div",D,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=t=>e.first_name=t),class:"form-control",placeholder:"Имя пользователя",required:""},null,512),[[a["vModelText"],e.first_name]])])]),R,Object(a["createElementVNode"])("div",F,[P,Object(a["createElementVNode"])("div",X,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{type:"email","onUpdate:modelValue":t[9]||(t[9]=t=>e.email=t),class:"form-control",placeholder:"email",required:""},null,512),[[a["vModelText"],e.email]]),e.msg.email?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",Y,Object(a["toDisplayString"])(e.msg.email),1)):Object(a["createCommentVNode"])("",!0)])]),q,Object(a["createElementVNode"])("div",z,[G,Object(a["createElementVNode"])("div",H,[Object(a["createVNode"])(ce,{searchable:!0,modelValue:e.city,"onUpdate:modelValue":t[10]||(t[10]=t=>e.city=t),options:e.opt_cities,required:""},null,8,["modelValue","options"])])]),J,Object(a["createElementVNode"])("div",Q,[Z,Object(a["createElementVNode"])("div",K,[Object(a["createVNode"])(ce,{searchable:!0,modelValue:e.region,"onUpdate:modelValue":t[11]||(t[11]=t=>e.region=t),options:e.opt_regions,required:""},null,8,["modelValue","options"])])]),W,Object(a["createElementVNode"])("div",ee,[te,Object(a["createElementVNode"])("div",le,[Object(a["createVNode"])(ie,{class:"input-text",editor:e.editor,modelValue:e.bio,"onUpdate:modelValue":t[12]||(t[12]=t=>e.bio=t),config:e.editorConfig},null,8,["editor","modelValue","config"])])]),ae])])])])])])])])],4)],64)}var oe=l("bc3a"),ce=l.n(oe),ie=l("95c3"),re=l.n(ie),ne=(l("6107"),l("3730")),de=l.n(ne),me=l("abd1"),be=l.n(me),pe=l("a306"),he=l("0180"),ue={components:{ckeditor:de.a.component,VueCropper:re.a,Multiselect:pe["a"]},name:"panel_change",props:["slug"],data:()=>({user:{},cur_user:{},username:"",password:"",email:"",selected_file:null,imgSrc:"",first_name:"",city:"",bio:"",error:"",cities:[],opt_cities:[],region:"",regions:[],user_region:{},opt_regions:[],msg:[],oldpas:"",newpas:"",loading:!1,toast:Object(he["c"])(),editorConfig:{toolbar:{items:["heading","|","bold","italic","link","bulletedList","numberedList","|","outdent","indent","|","imageUpload","blockQuote","insertTable","mediaEmbed","undo","redo"]},language:"ru",image:{toolbar:["imageTextAlternative","imageStyle:alignLeft","imageStyle:inLine","imageStyle:alignRight","toggleImageCaption","imageStyle:alignCenter","imageStyle:centeredImage"]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"]},simpleUpload:{uploadUrl:""}},editor:be.a}),watch:{email(e){this.email=e,this.validateEmail(e)}},created(){this.loadUser(),this.loadListCities(),this.loadListRegions(),this.editorConfig.simpleUpload.uploadUrl=this.$store.state.backendUrl+"api/v1/upload_img/none/"},methods:{cropImage(){this.selected_file=this.$refs.cropper.getCroppedCanvas().toDataURL()},flipX(){const e=this.$refs.flipX;let t=e.getAttribute("data-scale");t=t?-t:-1,this.$refs.cropper.scaleX(t),e.setAttribute("data-scale",t)},flipY(){const e=this.$refs.flipY;let t=e.getAttribute("data-scale");t=t?-t:-1,this.$refs.cropper.scaleY(t),e.setAttribute("data-scale",t)},reset(){this.$refs.cropper.reset()},rotate(e){this.$refs.cropper.rotate(e)},setImage(e){const t=e.target.files[0];if(-1!==t.type.indexOf("image/"))if("function"===typeof FileReader){const e=new FileReader;e.onload=e=>{this.imgSrc=e.target.result,this.$refs.cropper.replace(e.target.result)},e.readAsDataURL(t)}else this.toast.error("Простите, FileReader API не поддерживаеться");else this.toast.error("Выберите файл с фото")},showFileChooser(){this.$refs.input.click()},zoom(e){this.$refs.cropper.relativeZoom(e)},onFileSelected(e){this.selected_file=e.target.files[0]},async loadUser(){const e=await fetch(this.$store.state.backendUrl+`api/v1/${this.slug}/`,{method:"GET",headers:{"Content-type":"application/json"}}).then(e=>e.json()).catch(e=>{let t=this.$router.resolve({name:"404"});window.location.assign(t.href)});if(this.user=e,this.username=e.username,this.first_name=e.first_name,this.email=e.email,this.city=e.city.title,this.region=e.region.title,this.user_region=e.region,this.bio=e.bio,this.cur_user=this.$store.state.cuser,this.user.email!==this.cur_user.email){let e=this.$router.resolve({name:"404"});window.location.assign(e.href)}},loadListCities(){ce()({url:this.$store.state.backendUrl+"api/v1/city",method:"GET",headers:{"Content-type":"application/json"}}).then(e=>{for(var t in this.cities=e.data,e.data)this.opt_cities.push(e.data[t].title)})},loadListRegions(){ce()({url:this.$store.state.backendUrl+"api/v1/regions",method:"GET",headers:{"Content-type":"application/json"}}).then(e=>{for(var t in this.regions=e.data,e.data)this.opt_regions.push(e.data[t].title)})},update:function(){if(this.msg["email"]||this.user.email!=this.cur_user.email)this.toast.error(" Произошла ошибка. Введите валидные данные или попробуйте позже ");else{const e=new FormData;this.region&&(this.region=this.regions.find(e=>e.title===this.region).slug),e.append("first_name",this.first_name),e.append("email",this.email),null!=this.selected_file&&e.append("profile_img",this.selected_file),this.city&&(this.city=this.cities.find(e=>e.title===this.city).slug),null!=this.city&&e.append("city",this.city),null!=this.region&&e.append("region",this.region),e.append("bio",this.bio),this.loading=!0,ce()({url:this.$store.state.backendUrl+`api/v1/profile_edit/${this.user.slug}/`,data:e,method:"PUT"}).then(e=>{console.log(e),this.loading=!1;let t=this.$router.resolve({name:"home"});window.location.assign(t.href)}).catch(e=>{this.toast.error(" Произошла ошибка. Введите валидные данные или попробуйте позже "),this.loading=!1})}},validateEmail(e){/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)?this.msg["email"]="":this.msg["email"]="Это не похоже на email"},resetPassword(){const e=new FormData;this.loading=!0,e.append("email",this.user.email),ce()({url:this.$store.state.backendUrl+"auth/users/reset_password/",data:e,method:"POST"}).then(e=>{this.loading=!1,this.toast.success("На Вашу почту была выслана ссылка для смены пароля"),console.log(e)})}}},ge=(l("d742"),l("0948"),l("d959")),je=l.n(ge);const Oe=je()(ue,[["render",se],["__scopeId","data-v-49180319"]]);t["default"]=Oe},"3e96":function(e,t,l){}}]);
//# sourceMappingURL=chunk-e3002df8.7e15e2f0.js.map